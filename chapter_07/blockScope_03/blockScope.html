<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>模拟块级作用域</title>
</head>

<body>

</body>

<script>
    function outputNumbers(count) {
        for (var index = 0; index < count; index++) {

        }
        console.log(index)
    }
    outputNumbers(2)
    // 我们不希望在循环后还能访问到index变量，该怎么做呢？
</script>


<script>
    // 我们知道当一个函数执行完毕，它内部的变量就会被释放，后面就无法访问了
    // 因此我们可以将循环的代码放到一个函数中
    // 当函数执行完毕，就会销毁里面的变量

    function outputNumbers(count) {
        var a = 0
        var fun = function () {
            for (var index = 0; index < count; index++) {
                a += index
            }
        }
        // fun被创建 scope属性引用着作用域链：outputNumbers的AO -> window
        // fun执行 作用域链 funAO -> outputNumbers的AO -> window
        // index变量有 第一次循环是0
        // count变量一直都是3
        // 第1次循环 0+0
        // 第2次循环 0+1
        // 第3次循环 1+2
        // 最终输出3

        fun()
        console.log(index); // 报错

    }
</script>

<script>


    // 测试fun是否是一个闭包
    function outputNumbers(count) {
        var a = 0
        var fun = function () {
            for (var index = 0; index < count; index++) {
                a += index
            }
        }
        fun()
        return fun
    }
    var outFun = outputNumbers(3)
    outFun() // 执行的时候count=3，因为outputNumbers的AO一直在内存中，此时a的值是3

</script>

<script>
    // 如果不return
    // fun还是一个闭包吗？

    // 答案是 是的 
    // 因为只要这个函数可以访问到另一个函数作用域中的变量，它就可以被称为闭包

    // 和上面的区别是这里的闭包执行完后，就会释放outputNumbers的AO
    // 因为没有变量引用
    function outputNumbers(count) {
        var a = 0
        var fun = function () {
            for (var index = 0; index < count; index++) {
                a += index
            }
        }
        fun()
    }
    outputNumbers(3)
</script>



<script>
    /*
   定义函数：function () { }
   执行函数： function () { }()
   这样子是会报错的，因为js将 function作为一个关键字，表示函数声明
   而函数声明后面是不能加括号的

   因此我们需要告诉js引擎这个function () { }是一个函数表达式
   我们可以用 一堆括号把它包含起来，表示它是一个函数表达式 (function () { })
   之后，我们可以在它后面加上一堆括号表示执行这个 函数表达式
   (function () {

   })()
   这样子，在这个立即执行的函数中定义的变量外部都访问不到，因为当外部的代码想访问时，它已经被销毁了。

   */

</script>

</html>